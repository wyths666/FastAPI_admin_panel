<!-- templates/bot2_claims.html -->
{% extends "base.html" %}

{% block content %}
<div class="header-actions">
    <a href="/bot2/" class="btn" style="background: var(--gray);">‚Üê –ù–∞–∑–∞–¥</a>
    <a href="/auth/logout" class="btn btn-logout">üö™ –í—ã–π—Ç–∏</a>
</div>

<header>
    <h1>üìã –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–ø–ª–∞—Ç—ã</h1>
    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
</header>

<!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É -->
<div class="filters">
    <div class="filter-row">
        <div class="filter-group">
            <label>–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:</label>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="?status=all"
                   class="filter-button {% if not current_status or current_status == 'all' %}active{% endif %}">
                   –í—Å–µ ({{ status_counts.all }})
                </a>
                <a href="?status=pending"
                   class="filter-button {% if current_status == 'pending' %}active{% endif %}"
                   style="background: #fff3cd; color: #856404;">
                   ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ ({{ status_counts.pending }})
                </a>
                <a href="?status=confirm"
                   class="filter-button {% if current_status == 'confirm' %}active{% endif %}"
                   style="background: #d4edda; color: #155724;">
                   ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã ({{ status_counts.confirm }})
                </a>
                <a href="?status=cancelled"
                   class="filter-button {% if current_status == 'cancelled' %}active{% endif %}"
                   style="background: #f8d7da; color: #721c24;">
                   ‚ùå –û—Ç–º–µ–Ω–µ–Ω—ã ({{ status_counts.cancelled }})
                </a>
            </div>
        </div>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ -->
{% for item in claims %}
<div class="order" onclick="window.location.href='/bot2/claims/{{ item.claim.claim_id }}'">
    <div class="order-header">
        <div class="order-number">
            –ó–∞—è–≤–∫–∞ #{{ item.claim.claim_id }}
            {% if item.has_unanswered %}
            <span style="color: var(--danger); margin-left: 10px;">üí¨ –ï—Å—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
            {% endif %}
        </div>
        <div>
            <div class="order-status status-{{ item.claim.claim_status }}">
                {% if item.claim.claim_status == 'pending' %}‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ
                {% elif item.claim.claim_status == 'confirm' %}‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
                {% elif item.claim.claim_status == 'cancelled' %}‚ùå –û—Ç–º–µ–Ω–µ–Ω–∞
                {% else %}{{ item.claim.claim_status }}{% endif %}
            </div>
            <span class="toggle-icon">‚Ä∫</span>
        </div>
    </div>

    <div class="order-details">
        <p><strong>üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> {{ item.claim.user_id }}</p>
        <p><strong>üí∞ –°—É–º–º–∞:</strong> {{ "%.2f"|format(item.claim.amount) }} ‚ÇΩ</p>
        <p><strong>üìù –ú–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã:</strong>
            {% if item.claim.payment_method == 'phone' %}üì± –°–ë–ü
            {% elif item.claim.payment_method == 'card' %}üí≥ –ö–∞—Ä—Ç–∞
            {% else %}{{ item.claim.payment_method }}{% endif %}
        </p>
        <p><strong>üÜî –ö–æ–¥:</strong> {{ item.claim.code }} ({{ item.claim.code_status }})</p>
        <p><strong>üìÖ –°–æ–∑–¥–∞–Ω–∞:</strong> {{ item.claim.created_at.strftime('%d.%m.%Y %H:%M') }}</p>

        <div style="margin-top: 15px;">
            <a href="/bot2/claims/{{ item.claim.claim_id }}" class="btn">üìã –ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
    </div>
</div>
{% else %}
<div style="text-align: center; padding: 40px; background: white; border-radius: var(--radius);">
    <h3>üì≠ –ù–µ—Ç –∑–∞—è–≤–æ–∫</h3>
    <p>–ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–ø–ª–∞—Ç—ã –ø–æ–∫–∞ –Ω–µ –ø–æ—Å—Ç—É–ø–∞–ª–∏.</p>
</div>
{% endfor %}

<style>
.filter-button {
    padding: 8px 16px;
    background: var(--light);
    color: var(--dark);
    text-decoration: none;
    border-radius: var(--radius);
    border: 1px solid var(--border);
}

.filter-button.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.order {
    cursor: pointer;
    transition: all 0.3s ease;
}

.order:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px var(--shadow);
}
</style>
{% endblock %}